---
title: "Lab Demonstration 1 - Summarizing Categorical Variables"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Tidyverse

[Tidyverse](https://www.tidyverse.org/) is a collection of packages for the R programming language designed to to focus on exploring data rather than programming. Those that are really wanting to study how R's Tidyverse collection connects with Data Science in a more detailed way, then you'll want to explore the free book [R for Data Science](https://r4ds.had.co.nz) as it is quickly becoming the standard resource.

The command `library(tidyverse)` will load the Tidyverse tools into this project.

```{r, message = FALSE}
library(...)
```

## Lab Demonstration

In this lab demonstration, I will use use the tools of Tidyverse to summarize the distribution of categorical variables. Specifically, I will work with tabular data to create the following summaries:

* (relative) frequency tables
* mode
* bar charts

Following the demonstration, you will be asked to perform a similar set of tasks.

## The Data

"In October of 2018, the Board of Supervisors passed and Mayor London N. Breed signed, the Ordinance 243-18 (http://bit.ly/2LSqS3U) to expand the extent to which women are represented in the public sphere, including within artwork, statues, street names, facilities, parks, and more. The representation of women in City-owned buildings includes buildings, conference rooms, clubhouses, museums, recreation centers, community rooms, auditoriums, terminals, departure halls, 7 staircases, rooms, and other places open to the public. The City Administrator's office was responsible for compiling a list of all city owned buildings named after a man or woman."

This statement, the most up-to-date dataset, and details about the variables in the dataset can be found on [the data.sfgov.org website for this project](https://data.sfgov.org/dataset/Representation-of-Women-in-City-Property-City-Admi/9y57-xm9y).

The following code chunk will read the data provided by the city and county of San Francisco as of August 18, 2020. I've set this document up, so that the data is stored in a tibble called `sfdata`. A tibble is the Tidyverse version of a table.

```{r, message = FALSE}
... <- read_csv("https://raw.githubusercontent.com/shawnwiggins/probabilityandstatistics/master/datasets/Representation_of_Women_in_City_Property_-_City_Administrator_s_List.csv")
```

There is a lot of data in this dataset, but we can look at the first ten rows of data by typing the name of the tibble in a code chunk. You should see that is says "A tibble: 72 x 13" meaning that our data is in Tidyverse's tabular form with 72 rows and 13 columns.

```{r}
...
```

Additionally, the following code chunk will show all the column names in the dataset. Since the column names are the variables, this will also be a list of all the variables.

```{r}
colnames(...)
```

## Summarizing the Variable `gender`

The dataset consists of a variable called `gender` and this variable is categorical. The following code will take the dataset, select the gender variable, and identify the unique values of this variable.

```{r}
sfdata %>%
  select(...) %>%
  summarize(unique(...))
```

This variable represents the gender of the individual for which the associated building was named after. According to the output of the code above, it has the three possible values of `M`, `M/F`, or `F`. 

For clarification, the gender labeling is binary and the `M/F` value is attached to a building that is named after both a male and female labeled individuals such as Mark and Priscilla Zuckerberg.

### Frequency Table with Relative Frequencies

One of the standard summaries for a categorical variable is a frequency table. It is common to express the frequencies as relative frequencies. I will use the following code to create a new tibble called `frequency_table` with three columns. The first column will be the gender values, the second column will be the frequency for each value for the variable in the dataset, and the last column will be the relative frequency for the values.

It is important to notice that all of the other summaries will use this frequency table, so creating one is an important first step in summarizing a categorical variable.

```{r}
... <- sfdata %>%
  count(gender, name = 'freq') %>%
  mutate(relativeFreq = prop.table(freq))
```

### Mode

You can easily look at the table and see that the most frequent gender value is `M`, but you can calculate this mode using R in case you have a lot of values to look through in your dataset.

This code sorts the frequency table by the frequency column in descending order. The first row will contain the most frequent gender value. In other words, the first gender value will be the mode. In the case when the variable is multimodal, then you would have to notice the first few rows of the sorted frequency table.

For those that are curious, if you use `arrange(freq)` instead, then you would get a table sorted in ascending order by frequencies.

```{r}
frequency_table %>%
  arrange(desc(freq))
```

### Bar Chart

`ggplot` is the library in Tidyverse that allows us to make professional graphics quickly. The standard visualization used to summarize categorical data is a bar chart. The geometry `geom_col()` is what produces the bar chart in the following code chunk where we apply `ggplot` to our frequency table. Each bar represents one of the gender values with the aesthetic `x = gender`. The heights of the bars are determined by the aesthetic `y = relativeFreq`.

```{r}
ggplot(frequency_table, aes(x = gender, y = relativeFreq)) + 
  ... + 
  ggtitle('Gender Labels Associated with Buildings in San Francisco') +
  xlab('Gender') +
  ylab('Relative Frequency')
```

### Sample Summary

You can point out many different things about these summaries. If this isn't your presentation, then you want to imagine or figure out what the presenter would want to point out using these summaries. I imagine that by passing and signing this ordinance, the Board of Supervisors and Mayor Breed would want to point out the large difference between the percentage of buildings named after males and the percentage of buildings named after females. Additionaly, the details in the ordinance state that the proportion of female named buildings should be 30%. The following is my sample summary based on this assumption about what they might want. 

...
